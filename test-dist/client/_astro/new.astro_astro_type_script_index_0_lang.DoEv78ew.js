/* empty css                      */const g=document.getElementById("postForm"),n=document.getElementById("error"),p=document.getElementById("title"),i=document.getElementById("slug");p.addEventListener("input",()=>{if(!i.dataset.manual){const o=p.value.toLowerCase().replace(/[^a-z0-9\s]+/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,"");i.value=o}});i.addEventListener("input",()=>{i.dataset.manual="true"});const c=document.getElementById("uploadCoverBtn"),v=document.getElementById("coverImage"),f=document.getElementById("coverPlaceholder"),r=document.getElementById("coverPreviewImg"),m=document.getElementById("uploadBtnText"),u=document.getElementById("removeCoverBtn");c.addEventListener("click",()=>{const o=document.createElement("input");o.type="file",o.accept="image/*",o.onchange=async t=>{const s=t.target.files?.[0];if(s)try{c.disabled=!0,m.textContent="Uploading...";const d=new FormData;d.append("file",s);const e=await fetch("/api/upload",{method:"POST",body:d,credentials:"include"});if(!e.ok){const h=await e.text();console.error("Upload failed:",e.status,h);let l="Failed to upload image";e.status===401?l="Authentication required. Please log in again.":e.status===413&&(l="Image file is too large (max 25MB)"),n.textContent=l,n.classList.remove("hidden");return}const a=await e.json();a.url&&(v.value=a.url,r.src=a.url,r.classList.remove("hidden"),f.classList.add("hidden"),m.textContent="Change Image",u.classList.remove("hidden"),n.classList.add("hidden"))}catch(d){console.error("Upload error:",d),n.textContent="Failed to upload image. Please try again.",n.classList.remove("hidden")}finally{c.disabled=!1}},o.click()});u.addEventListener("click",()=>{v.value="",r.src="",r.classList.add("hidden"),f.classList.remove("hidden"),m.textContent="Upload Image",u.classList.add("hidden")});g.addEventListener("submit",async o=>{o.preventDefault();const t=new FormData(g);let s=t.get("content")||"";!s&&typeof window<"u"&&window.__editorContent&&(s=window.__editorContent);const d={title:t.get("title"),slug:t.get("slug")||void 0,description:t.get("description"),content:s,type:t.get("type"),category:t.get("category"),coverImage:t.get("coverImage")||void 0,published:t.get("published")==="on"};try{const e=await fetch("https://codersinflow.com/api/posts",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)});if(e.ok){const a=await e.json();window.location.href=`/editor/posts/edit/${a.id}?saved=true`}else{const a=await e.text();n.textContent=a||"Failed to create post",n.classList.remove("hidden")}}catch{n.textContent="Network error. Please try again.",n.classList.remove("hidden")}});
