/* empty css                      */const u=document.getElementById("postForm"),t=document.getElementById("error"),l=document.getElementById("uploadCoverBtn"),p=document.getElementById("coverImage"),v=document.getElementById("coverPlaceholder"),i=document.getElementById("coverPreviewImg"),m=document.getElementById("uploadBtnText"),g=document.getElementById("removeCoverBtn");l.addEventListener("click",()=>{const d=document.createElement("input");d.type="file",d.accept="image/*",d.onchange=async e=>{const s=e.target.files?.[0];if(s)try{l.disabled=!0,m.textContent="Uploading...";const o=new FormData;o.append("file",s);const n=await fetch("/api/upload",{method:"POST",body:o,credentials:"include"});if(!n.ok){const r=await n.text();console.error("Upload failed:",n.status,r);let c="Failed to upload image";n.status===401?c="Authentication required. Please log in again.":n.status===413&&(c="Image file is too large (max 25MB)"),t.textContent=c,t.classList.remove("hidden");return}const a=await n.json();a.url&&(p.value=a.url,i.src=a.url,i.classList.remove("hidden"),v.classList.add("hidden"),m.textContent="Change Image",g.classList.remove("hidden"),t.classList.add("hidden"))}catch(o){console.error("Upload error:",o),t.textContent="Failed to upload image. Please try again.",t.classList.remove("hidden")}finally{l.disabled=!1}},d.click()});g.addEventListener("click",()=>{p.value="",i.src="",i.classList.add("hidden"),v.classList.remove("hidden"),m.textContent="Upload Image",g.classList.add("hidden")});u.addEventListener("submit",async d=>{d.preventDefault();const e=new FormData(u),s=e.get("id");let o=e.get("content")||"";!o&&typeof window<"u"&&window.__editorContent&&(o=window.__editorContent);const n={title:e.get("title"),slug:e.get("slug"),description:e.get("description"),content:o,type:e.get("type"),category:e.get("category"),coverImage:e.get("coverImage")||void 0,published:e.get("published")==="on"};try{const a=await fetch(`https://codersinflow.com/api/posts/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(n)});if(a.ok)window.location.href=`/editor/posts/edit/${s}?saved=true`;else{const r=await a.text();t.textContent=r||"Failed to update post",t.classList.remove("hidden")}}catch{t.textContent="Network error. Please try again.",t.classList.remove("hidden")}});
